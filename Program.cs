
using ConsoleAppOpenAI;
using Microsoft.Extensions.Configuration;
using Newtonsoft.Json.Linq;
using System.Data;
using System.Net.Http.Headers;
using System.Text;

namespace ChatGptDemo
{
    internal class Program
    {

        static List<List<int>> GetCombination(List<int> list)
        {
            var res = new List<List<int>>();
            double count = Math.Pow(2, list.Count);
            for (int i = 1; i <= count - 1; i++)
            {
                var entry = new List<int>();
                string str = Convert.ToString(i, 2).PadLeft(list.Count, '0');
                for (int j = 0; j < str.Length; j++)
                {
                    if (str[j] == '1')
                    {
                       entry.Add(list[j]);
                    }
                }
                res.Add(entry);
            }
            return res;
        }

        static async Task Main(string[] args)
        {
            var list = new List<int>();
            for (int i = 0; i < 14; i++)
            {
                list.Add(i);
            }

            var combinations = GetCombination(list);
            var stringCombinations = combinations.Select(x => string.Join(string.Empty, x)).ToArray();
            var res = string.Join(' ', stringCombinations);
            var msg = res;
            //var msg = "12 11 1112 10 1012 1011 101112 9 912 911 91112 910 91012 91011 9101112 8 812 811 81112 810 81012 81011 8101112 89 8912 8911 891112 8910 891012 891011 89101112 7 712 711 71112 710 71012 71011 7101112 79 7912 7911 791112 7910 791012 791011 79101112 78 7812 7811 781112 7810 781012 781011 78101112 789 78912 78911 7891112 78910 7891012 7891011 789101112 6 612 611 61112 610 61012 61011 6101112 69 6912 6911 691112 6910 691012 691011 69101112 68 6812 6811 681112 6810 681012 681011 68101112 689 68912 68911 6891112 68910 6891012 6891011 689101112 67 6712 6711 671112 6710 671012 671011 67101112 679 67912 67911 6791112 67910 6791012 6791011 679101112 678 67812 67811 6781112 67810 6781012 6781011 678101112 6789 678912 678911 67891112 678910 67891012 67891011 6789101112 5 512 511 51112 510 51012 51011 5101112 59 5912 5911 591112 5910 591012 591011 59101112 58 5812 5811 581112 5810 581012 581011 58101112 589 58912 58911 5891112 58910 5891012 5891011 589101112 57 5712 5711 571112 5710 571012 571011 57101112 579 57912 57911 5791112 57910 5791012 5791011 579101112 578 57812 57811 5781112 57810 5781012 5781011 578101112 5789 578912 578911 57891112 578910 57891012 57891011 5789101112 56 5612 5611 561112 5610 561012 561011 56101112 569 56912 56911 5691112 56910 5691012 5691011 569101112 568 56812 56811 5681112 56810 5681012 5681011 568101112 5689 568912 568911 56891112 568910 56891012 56891011 5689101112 567 56712 56711 5671112 56710 5671012 5671011 567101112 5679 567912 567911 56791112 567910 56791012 56791011 5679101112 5678 567812 567811 56781112 567810 56781012 56781011 5678101112 56789 5678912 5678911 567891112 5678910 567891012 567891011 56789101112 4 412 411 41112 410 41012 41011 4101112 49 4912 4911 491112 4910 491012 491011 49101112 48 4812 4811 481112 4810 481012 481011 48101112 489 48912 48911 4891112 48910 4891012 4891011 489101112 47 4712 4711 471112 4710 471012 471011 47101112 479 47912 47911 4791112 47910 4791012 4791011 479101112 478 47812 47811 4781112 47810 4781012 4781011 478101112 4789 478912 478911 47891112 478910 47891012 47891011 4789101112 46 4612 4611 461112 4610 461012 461011 46101112 469 46912 46911 4691112 46910 4691012 4691011 469101112 468 46812 46811 4681112 46810 4681012 4681011 468101112 4689 468912 468911 46891112 468910 46891012 46891011 4689101112 467 46712 46711 4671112 46710 4671012 4671011 467101112 4679 467912 467911 46791112 467910 46791012 46791011 4679101112 4678 467812 467811 46781112 467810 46781012 46781011 4678101112 46789 4678912 4678911 467891112 4678910 467891012 467891011 46789101112 45 4512 4511 451112 4510 451012 451011 45101112 459 45912 45911 4591112 45910 4591012 4591011 459101112 458 45812 45811 4581112 45810 4581012 4581011 458101112 4589 458912 458911 45891112 458910 45891012 45891011 4589101112 457 45712 45711 4571112 45710 4571012 4571011 457101112 4579 457912 457911 45791112 457910 45791012 45791011 4579101112 4578 457812 457811 45781112 457810 45781012 45781011 4578101112 45789 4578912 4578911 457891112 4578910 457891012 457891011 45789101112 456 45612 45611 4561112 45610 4561012 4561011 456101112 4569 456912 456911 45691112 456910 45691012 45691011 4569101112 4568 456812 456811 45681112 456810 45681012 45681011 4568101112 45689 4568912 4568911 456891112 4568910 456891012 456891011 45689101112 4567 456712 456711 45671112 456710 45671012 45671011 4567101112 45679 4567912 4567911 456791112 4567910 456791012 456791011 45679101112 45678 4567812 4567811 456781112 4567810 456781012 456781011 45678101112 456789 45678912 45678911 4567891112 45678910 4567891012 4567891011 456789101112 3 312 311 31112 310 31012 31011 3101112 39 3912 3911 391112 3910 391012 391011 39101112 38 3812 3811 381112 3810 381012 381011 38101112 389 38912 38911 3891112 38910 3891012 3891011 389101112 37 3712 3711 371112 3710 371012 371011 37101112 379 37912 37911 3791112 37910 3791012 3791011 379101112 378 37812 37811 3781112 37810 3781012 3781011 378101112 3789 378912 378911 37891112 378910 37891012 37891011 3789101112 36 3612 3611 361112 3610 361012 361011 36101112 369 36912 36911 3691112 36910 3691012 3691011 369101112 368 36812 36811 3681112 36810 3681012 3681011 368101112 3689 368912 368911 36891112 368910 36891012 36891011 3689101112 367 36712 36711 3671112 36710 3671012 3671011 367101112 3679 367912 367911 36791112 367910 36791012 36791011 3679101112 3678 367812 367811 36781112 367810 36781012 36781011 3678101112 36789 3678912 3678911 367891112 3678910 367891012 367891011 36789101112 35 3512 3511 351112 3510 351012 351011 35101112 359 35912 35911 3591112 35910 3591012 3591011 359101112 358 35812 35811 3581112 35810 3581012 3581011 358101112 3589 358912 358911 35891112 358910 35891012 35891011 3589101112 357 35712 35711 3571112 35710 3571012 3571011 357101112 3579 357912 357911 35791112 357910 35791012 35791011 3579101112 3578 357812 357811 35781112 357810 35781012 35781011 3578101112 35789 3578912 3578911 357891112 3578910 357891012 357891011 35789101112 356 35612 35611 3561112 35610 3561012 3561011 356101112 3569 356912 356911 35691112 356910 35691012 35691011 3569101112 3568 356812 356811 35681112 356810 35681012 35681011 3568101112 35689 3568912 3568911 356891112 3568910 356891012 356891011 35689101112 3567 356712 356711 35671112 356710 35671012 35671011 3567101112 35679 3567912 3567911 356791112 3567910 356791012 356791011 35679101112 35678 3567812 3567811 356781112 3567810 356781012 356781011 35678101112 356789 35678912 35678911 3567891112 35678910 3567891012 3567891011 356789101112 34 3412 3411 341112 3410 341012 341011 34101112 349 34912 34911 3491112 34910 3491012 3491011 349101112 348 34812 34811 3481112 34810 3481012 3481011 348101112 3489 348912 348911 34891112 348910 34891012 34891011 3489101112 347 34712 34711 3471112 34710 3471012 3471011 347101112 3479 347912 347911 34791112 347910 34791012 34791011 3479101112 3478 347812 347811 34781112 347810 34781012 34781011 3478101112 34789 3478912 3478911 347891112 3478910 347891012 347891011 34789101112 346 34612 34611 3461112 34610 3461012 3461011 346101112 3469 346912 346911 34691112 346910 34691012 34691011 3469101112 3468 346812 346811 34681112 346810 34681012 34681011 3468101112 34689 3468912 3468911 346891112 3468910 346891012 346891011 34689101112 3467 346712 346711 34671112 346710 34671012 34671011 3467101112 34679 3467912 3467911 346791112 3467910 346791012 346791011 34679101112 34678 3467812 3467811 346781112 3467810 346781012 346781011 34678101112 346789 34678912 34678911 3467891112 34678910 3467891012 3467891011 346789101112 345 34512 34511 3451112 34510 3451012 3451011 345101112 3459 345912 345911 34591112 345910 34591012 34591011 3459101112 3458 345812 345811 34581112 345810 34581012 34581011 3458101112 34589 3458912 3458911 345891112 3458910 345891012 345891011 34589101112 3457 345712 345711 34571112 345710 34571012 34571011 3457101112 34579 3457912 3457911 345791112 3457910 345791012 345791011 34579101112 34578 3457812 3457811 345781112 3457810 345781012 345781011 34578101112 345789 34578912 34578911 3457891112 34578910 3457891012 3457891011 345789101112 3456 345612 345611 34561112 345610 34561012 34561011 3456101112 34569 3456912 3456911 345691112 3456910 345691012 345691011 34569101112 34568 3456812 3456811 345681112 3456810 345681012 345681011 34568101112 345689 34568912 34568911 3456891112 34568910 3456891012 3456891011 345689101112 34567 3456712 3456711 345671112 3456710 345671012 345671011 34567101112 345679 34567912 34567911 3456791112 34567910 3456791012 3456791011 345679101112 345678 34567812 34567811 3456781112 34567810 3456781012 3456781011 345678101112 3456789 345678912 345678911 34567891112 345678910 34567891012 34567891011 3456789101112 2 212 211 21112 210 21012 21011 2101112 29 2912 2911 291112 2910 291012 291011 29101112 28 2812 2811 281112 2810 281012 281011 28101112 289 28912 28911 2891112 28910 2891012 2891011 289101112 27 2712 2711 271112 2710 271012 271011 27101112 279 27912 27911 2791112 27910 2791012 2791011 279101112 278 27812 27811 2781112 27810 2781012 2781011 278101112 2789 278912 278911 27891112 278910 27891012 27891011 2789101112 26 2612 2611 261112 2610 261012 261011 26101112 269 26912 26911 2691112 26910 2691012 2691011 269101112 268 26812 26811 2681112 26810 2681012 2681011 268101112 2689 268912 268911 26891112 268910 26891012 26891011 2689101112 267 26712 26711 2671112 26710 2671012 2671011 267101112 2679 267912 267911 26791112 267910 26791012 26791011 2679101112 2678 267812 267811 26781112 267810 26781012 26781011 2678101112 26789 2678912 2678911 267891112 2678910 267891012 267891011 26789101112 25 2512 2511 251112 2510 251012 251011 25101112 259 25912 25911 2591112 25910 2591012 2591011 259101112 258 25812 25811 2581112 25810 2581012 2581011 258101112 2589 258912 258911 25891112 258910 25891012 25891011 2589101112 257 25712 25711 2571112 25710 2571012 2571011 257101112 2579 257912 257911 25791112 257910 25791012 25791011 2579101112 2578 257812 257811 25781112 257810 25781012 25781011 2578101112 25789 2578912 2578911 257891112 2578910 257891012 257891011 25789101112 256 25612 25611 2561112 25610 2561012 2561011 256101112 2569 256912 256911 25691112 256910 25691012 25691011 2569101112 2568 256812 256811 25681112 256810 25681012 25681011 2568101112 25689 2568912 2568911 256891112 2568910 256891012 256891011 25689101112 2567 256712 256711 25671112 256710 25671012 25671011 2567101112 25679 2567912 2567911 256791112 2567910 256791012 256791011 25679101112 25678 2567812 2567811 256781112 2567810 256781012 256781011 25678101112 256789 25678912 25678911 2567891112 25678910 2567891012 2567891011 256789101112 24 2412 2411 241112 2410 241012 241011 24101112 249 24912 24911 2491112 24910 2491012 2491011 249101112 248 24812 24811 2481112 24810 2481012 2481011 248101112 2489 248912 248911 24891112 248910 24891012 24891011 2489101112 247 24712 24711 2471112 24710 2471012 2471011 247101112 2479 247912 247911 24791112 247910 24791012 24791011 2479101112 2478 247812 247811 24781112 247810 24781012 24781011 2478101112 24789 2478912 2478911 247891112 2478910 247891012 247891011 24789101112 246 24612 24611 2461112 24610 2461012 2461011 246101112 2469 246912 246911 24691112 246910 24691012 24691011 2469101112 2468 246812 246811 24681112 246810 24681012 24681011 2468101112 24689 2468912 2468911 246891112 2468910 246891012 246891011 24689101112 2467 246712 246711 24671112 246710 24671012 24671011 2467101112 24679 2467912 2467911 246791112 2467910 246791012 246791011 24679101112 24678 2467812 2467811 246781112 2467810 246781012 246781011 24678101112 246789 24678912 24678911 2467891112 24678910 2467891012 2467891011 246789101112 245 24512 24511 2451112 24510 2451012 2451011 245101112 2459 245912 245911 24591112 245910 24591012 24591011 2459101112 2458 245812 245811 24581112 245810 24581012 24581011 2458101112 24589 2458912 2458911 245891112 2458910 245891012 245891011 24589101112 2457 245712 245711 24571112 245710 24571012 24571011 2457101112 24579 2457912 2457911 245791112 2457910 245791012 245791011 24579101112 24578 2457812 2457811 245781112 2457810 245781012 245781011 24578101112 245789 24578912 24578911 2457891112 24578910 2457891012 2457891011 245789101112 2456 245612 245611 24561112 245610 24561012 24561011 2456101112 24569 2456912 2456911 245691112 2456910 245691012 245691011 24569101112 24568 2456812 2456811 245681112 2456810 245681012 245681011 24568101112 245689 24568912 24568911 2456891112 24568910 2456891012 2456891011 245689101112 24567 2456712 2456711 245671112 2456710 245671012 245671011 24567101112 245679 24567912 24567911 2456791112 24567910 2456791012 2456791011 245679101112 245678 24567812 24567811 2456781112 24567810 2456781012 2456781011 245678101112 2456789 245678912 245678911 24567891112 245678910 24567891012 24567891011 2456789101112 23 2312 2311 231112 2310 231012 231011 23101112 239 23912 23911 2391112 23910 2391012 2391011 239101112 238 23812 23811 2381112 23810 2381012 2381011 238101112 2389 238912 238911 23891112 238910 23891012 23891011 2389101112 237 23712 23711 2371112 23710 2371012 2371011 237101112 2379 237912 237911 23791112 237910 23791012 23791011 2379101112 2378 237812 237811 23781112 237810 23781012 23781011 2378101112 23789 2378912 2378911 237891112 2378910 237891012 237891011 23789101112 236 23612 23611 2361112 23610 2361012 2361011 236101112 2369 236912 236911 23691112 236910 23691012 23691011 2369101112 2368 236812 236811 23681112 236810 23681012 23681011 2368101112 23689 2368912 2368911 236891112 2368910 236891012 236891011 23689101112 2367 236712 236711 23671112 236710 23671012 23671011 2367101112 23679 2367912 2367911 236791112 2367910 236791012 236791011 23679101112 23678 2367812 2367811 236781112 2367810 236781012 236781011 23678101112 236789 23678912 23678911 2367891112 23678910 2367891012 2367891011 236789101112 235 23512 23511 2351112 23510 2351012 2351011 235101112 2359 235912 235911 23591112 235910 23591012 23591011 2359101112 2358 235812 235811 23581112 235810 23581012 23581011 2358101112 23589 2358912 2358911 235891112 2358910 235891012 235891011 23589101112 2357 235712 235711 23571112 235710 23571012 23571011 2357101112 23579 2357912 2357911 235791112 2357910 235791012 235791011 23579101112 23578 2357812 2357811 235781112 2357810 235781012 235781011 23578101112 235789 23578912 23578911 2357891112 23578910 2357891012 2357891011 235789101112 2356 235612 235611 23561112 235610 23561012 23561011 235678912 235678911 23567891112 235678910 23567891012 23567891011 2356789101112 234 23412 23411 2341112 23410 2341012 2341011 234101112 2349 234912 234911 23491112 234910 23491012 23491011 2349101112 2348 234812 234811 23481112 234810 23481012 23481011 2348101112 23489 2348912 2348911 234891112 2348910 234891012 234891011 23489101112 2347 234712 234711 23471112 234710 23471012 23471011 2347101112 23479 2347912 2347911 234791112 2347910 234791012 234791011 23479101112 23478 2347812 2347811 234781112 2347810 234781012 234781011 23478101112 234789 23478912 23478911 2347891112 23478910 2347891012 2347891011 234789101112 2346 234612 234611 23461112 234610 23461012 23461011 2346101112 23469 2346912 2346911 234691112 2346910 234691012 234691011 23469101112 23468 2346812 2346811 234681112 2346810 234681012 234681011 23468101112 234689 23468912 23468911 2346891112 23468910 2346891012 2346891011 234689101112 23467 2346712 2346711 234671112 2346710 234671012 234671011 23467101112 234679 23467912 23467911 2346791112 23467910 2346791012 2346791011 234679101112 234678 23467812 23467811 2346781112 23467810 2346781012 2346781011 234678101112 2346789 234678912 234678911 23467891112 234678910 23467891012 23467891011 2346789101112 2345 234512 234511 23451112 234510 23451012 23451011 2345101112 23459 2345912 2345911 234591112 2345910 234591012 234591011 23459101112 23458 2345812 2345811 234581112 2345810 234581012 234581011 23458101112 234589 23458912 23458911 2345891112 23458910 2345891012 2345891011 234589101112 23457 2345712 2345711 234571112 2345710 234571012 234571011 23457101112 234579 23457912 23457911 2345791112 23457910 2345791012 2345791011 234579101112 234578 23457812 23457811 2345781112 23457810 2345781012 2345781011 234578101112 2345789 234578912 234578911 23457891112 234578910 23457891012 23457891011 2345789101112 23456 2345612 2345611 234561112 2345610 234561012 234561011 23456101112 234569 23456912 23456911 2345691112 23456910 2345691012 2345691011 234569101112 234568 23456812 23456811 2345681112 23456810 2345681012 2345681011 234568101112 2345689 234568912 234568911 23456891112 234568910 23456891012 23456891011 2345689101112 234567 23456712 23456711 2345671112 23456710 2345671012 2345671011 234567101112 2345679 234567912 234567911 23456791112 234567910 23456791012 23456791011 2345679101112 2345678 234567812 234567811 23456781112 234567810 23456781012 23456781011 2345678101112 23456789 2345678912 2345678911 234567891112 2345678910 234567891012 234567891011 23456789101112 1 112 111 11112 110 11012 11011 1101112 19 1912 1911 191112 1910 191012 191011 19101112 18 1812 1811 181112 1810 181012 181011 18101112 189 18912 18911 1891112 18910 1891012 1891011 189101112 17 1712 1711 171112 1710 171012 171011 17101112 179 17912 17911 1791112 17910 1791012 1791011 179101112 178 17812 17811 1781112 17810 1781012 1781011 178101112 1789 178912 178911 17891112 178910 17891012 17891011 1789101112 16 1612 1611 161112 1610 161012 161011 16101112 169 16912 16911 1691112 16910 1691012 1691011 169101112 168 16812 16811 1681112 16810 1681012 1681011 168101112 1689 168912 168911 16891112 168910 16891012 16891011 1689101112 167 16712 16711 1671112 16710 1671012 1671011 167101112 1679 167912 167911 16791112 167910 16791012 16791011 1679101112 1678 167812 167811 16781112 167810 16781012 16781011 1678101112 16789 1678912 1678911 167891112 1678910 167891012 167891011 16789101112 15 1512 1511 151112 1510 151012 151011 15101112 159 15912 15911 1591112 15910 1591012 1591011 159101112 158 15812 15811 1581112 15810 1581012 1581011 158101112 1589 158912 158911 15891112 158910 15891012 15891011 1589101112 157 15712 15711 1571112 15710 1571012 1571011 157101112 1579 157912 157911 15791112 157910 15791012 15791011 1579101112 1578 157812 157811 15781112 157810 15781012 15781011 1578101112 15789 1578912 1578911 157891112 1578910 157891012 157891011 15789101112 156 15612 15611 1561112 15610 1561012 1561011 156101112 1569 156912 156911 15691112 156910 15691012 15691011 1569101112 1568 156812 156811 15681112 156810 15681012 15681011 1568101112 15689 1568912 1568911 156891112 1568910 156891012 156891011 15689101112 1567 156712 156711 15671112 156710 15671012 15671011 1567101112 15679 1567912 1567911 156791112 1567910 156791012 156791011 15679101112 15678 1567812 1567811 156781112 1567810 156781012 156781011 15678101112 156789 15678912 15678911 1567891112 15678910 1567891012 1";


            var apiKey = "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";
            OpenAIProxy chatOpenAI = new OpenAIProxy(apiKey);

            for (int i = 0; i < 3; i++) 
            {
                chatOpenAI.StackMessages(new Standard.AI.OpenAI.Models.Services.Foundations.ChatCompletions.ChatCompletionMessage
                {
                    Content = msg.Substring(0, msg.Length/3*2),
                    Role = "user"
                });
            }
            Console.WriteLine(msg);
            var results = await chatOpenAI.SendChatMessage(null);

            foreach (var item in results)
            {
                Console.WriteLine($"{item.Role}: {item.Content}");
            }

        }
    }
}